#!/bin/bash
# Pre-commit hook for hostcfg
# Runs the same checks as GitHub Actions CI

set -e

echo "Running pre-commit checks..."

# Verify dependencies
echo "Verifying dependencies..."
go mod verify

# Build
echo "Building..."
go build -v ./...

# Run golangci-lint (same as CI)
echo "Running golangci-lint..."
if command -v golangci-lint &> /dev/null; then
    golangci-lint run ./...
else
    echo "Error: golangci-lint not found"
    echo "Install with: mise install"
    exit 1
fi

# Run tests with race detector (same as CI)
echo "Running tests..."
go test -race ./...

echo "All pre-commit checks passed!"
